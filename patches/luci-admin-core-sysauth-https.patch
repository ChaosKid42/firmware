diff --git a/modules/admin-core/luasrc/view/sysauth.htm b/modules/admin-core/luasrc/view/sysauth.htm
index 7c39f0d..7f6bd28 100644
--- a/modules/admin-core/luasrc/view/sysauth.htm
+++ b/modules/admin-core/luasrc/view/sysauth.htm
@@ -13,7 +13,40 @@ You may obtain a copy of the License at
 
 <%+header%>
 
-<form method="post" action="<%=pcdata(luci.http.getenv("REQUEST_URI"))%>">
+<%
+local uci  = require "luci.model.uci".cursor()
+local fs  = require "nixio.fs"
+local https_key = uci:get("uhttpd", "main", "key") or ""
+local https_port = uci:get("uhttpd", "main", "listen_https")
+if type(https_port) == "table" then
+	https_port = https_port[1]
+end
+
+local action_uri
+local action_w
+local server_port = luci.http.getenv('SERVER_PORT')
+
+if https_port and fs.access(https_key) and server_port and server_port ~= https_port then
+	https_port = https_port:match("(%d+)$")
+	local protocol = "https://"
+	local host = luci.http.getenv('HTTP_HOST') or luci.http.getenv('SERVER_ADDR')
+	if https_port == "443" then
+		https_port = ''
+	else
+		https_port = ':' .. https_port
+	end
+
+	url = luci.dispatcher.build_url(...)
+	action_uri = protocol .. host .. https_port .. url
+else
+	action_uri = luci.http.getenv("REQUEST_URI")
+	if server_port ~= https_port then
+		action_w = "Warning no Encryption"
+	end
+end
+%>
+
+<form method="post" action="<%=pcdata(action_uri)%>">
 	<div class="cbi-map">
 		<h2><a id="content" name="content"><%:Authorization Required%></a></h2>
 		<div class="cbi-map-descr">
@@ -22,6 +55,11 @@ You may obtain a copy of the License at
 			<div class="error"><%:Invalid username and/or password! Please try again.%></div>
 			<br />
 			<% end -%>
+			<%- if action_w then %>
+			<br />
+			<div class="error"><h3><a><%=action_w%></a></h3></div>
+			<br />
+			<% end -%>
 		</div>
 		<fieldset class="cbi-section"><fieldset class="cbi-section-node">
 			<div class="cbi-value">
@@ -51,15 +89,7 @@ You may obtain a copy of the License at
 //]]></script>
 
 <%
-local uci  = require "luci.model.uci".cursor()
-local fs  = require "nixio.fs"
-local https_key = uci:get("uhttpd", "main", "key")
-local https_port = uci:get("uhttpd", "main", "listen_https")
-if type(https_port) == "table" then
-	https_port = https_port[1]
-end
-
-if https_port and fs.access(https_key) then
+if https_port and fs.access(https_key) and not luci.http.getenv('HTTPS') then
 	https_port = https_port:match("(%d+)$")
 %>
 
